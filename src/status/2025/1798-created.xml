<item>
   <title>Issue #1798 created</title>
   <pubDate>2025-02-12T20:37:31Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/1798</link>
   <guid>https://qt4cg.org/@qt4cg/2025/#created-1798</guid>
   <description>&lt;div&gt;&lt;p&gt;Getting the value of the new identity-(DM)property of a function. `fn:function-identity`&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;The current set of &lt;strong&gt;&lt;a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#functions-on-functions"&gt;Functions on Functions&lt;/a&gt;&lt;/strong&gt;: at &lt;strong&gt;(https://qt4cg.org/specifications/xpath-functions-40/Overview.html#functions-on-functions)&lt;/strong&gt; was recently updated with a new function to produce all annotations for a given function: &lt;strong&gt;&lt;a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-function-annotations"&gt;fn:function-annotations&lt;/a&gt;&lt;/strong&gt;.
However we are still missing the ability to reference another important, newly-added property of a function: the &lt;strong&gt;function identity: &lt;a href="https://qt4cg.org/specifications/xpath-datamodel-40/Overview.html#function-items"&gt;in DM&lt;/a&gt;&lt;/strong&gt; and &lt;strong&gt;&lt;a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-function-identity"&gt;in XPath&lt;/a&gt;&lt;/strong&gt;.&lt;/p&gt;
&lt;hr/&gt;
&lt;h1&gt;&lt;strong&gt;fn:function-identity&lt;/strong&gt;&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;Summary&lt;/strong&gt;
Returns &lt;strong&gt;&lt;em&gt;&lt;a href="https://qt4cg.org/specifications/xpath-datamodel-40/Overview.html#function-items"&gt;the identity of the function item&lt;/a&gt;&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Signature&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;fn:function-identity(
  $function	as fn(*)	
) as xs:string&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;Properties&lt;/strong&gt;
This function is &lt;a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-deterministic"&gt;·deterministic·&lt;/a&gt;, &lt;a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-context-independent"&gt;·context-independent·&lt;/a&gt;, and &lt;a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-focus-independent"&gt;·focus-independent·&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Notes&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;This function can be useful  in any scenario, where the evaluation of a function call requires repeated evaluation of this same, or other functions. Often in such cases, the algorithm needs access to a general structure, containing the cached results of executing possibly many different functions applied on specific arguments-tuples.
What &lt;strong&gt;unique key&lt;/strong&gt; is needed under which to group all invocations of a specific function and then the mapping between their function-call arguments and the result of the call? Remarkably, the identity of a function fits exactly the requirements (uniqueness / one per function) for such a key.
As we already have a function-identity property in the Data Model for each function-item, it is straightforward to provide this identity, and the &lt;strong&gt;&lt;code&gt;fn:function-identity&lt;/code&gt;&lt;/strong&gt; does exactly that.&lt;/li&gt;
&lt;li&gt;The function identity, by definition, is generated upon the creation of a function and has meaning throughout of the life of that function. It is not meaningful to store this value across different executions, because the identity given to a function in &lt;em&gt;execution1&lt;/em&gt; will generally be different from the identity, given to it in &lt;em&gt;execution2&lt;/em&gt;. However, the definitions of system functions (functions defined in the specifications under the system namespaces - with standard prefixes: &lt;strong&gt;&lt;em&gt;&lt;code&gt;xs&lt;/code&gt;, &lt;code&gt;fn&lt;/code&gt;, &lt;code&gt;map&lt;/code&gt;, &lt;code&gt;array&lt;/code&gt;, &lt;code&gt;math&lt;/code&gt;, &lt;code&gt;err&lt;/code&gt;, &lt;code&gt;output&lt;/code&gt;&lt;/em&gt;&lt;/strong&gt;) can be assigned permanent identities in the official Specs documents, requiring every implementation to use exactly this published identity value for the official, system functions, thus achieving efficiency and convenience during debugging.&lt;/li&gt;
&lt;li&gt;The function identity, being a string, can be used as a key in a map, thus making it possible to map a particular function to a sequence of items. It becomes possible to allow function items as map-keys by extending the definition of &lt;strong&gt;&lt;em&gt;&lt;a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-same-key"&gt;same-keys&lt;/a&gt;&lt;/em&gt;&lt;/strong&gt; with: "If both keys are function items: &lt;code&gt;$f1&lt;/code&gt; and &lt;code&gt;$f2&lt;/code&gt;, then they are &lt;strong&gt;the same&lt;/strong&gt; if and only if:
&lt;strong&gt;&lt;em&gt;&lt;code&gt;function-identity($f1) eq function-identity($f2)&lt;/code&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>
