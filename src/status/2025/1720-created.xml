<item>
   <title>Issue #1720 created</title>
   <pubDate>2025-01-22T10:50:32Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/1720</link>
   <guid>https://qt4cg.org/@qt4cg/2025/#created-1720</guid>
   <description>&lt;div&gt;&lt;p&gt;Grammar overhaul&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;There is a lot of dead wood in the xpath-grammar.xml file. This issue is raised to capture some observations and suggestions about how it can be simplified.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The DTD lists 19 attributes that can appear on g:token, and documents the meaning of 5 of them (very briefly). I suspect that many of the attributes are never used. Many of them were probably intended primarily for use by the JavaCC parser generator.&lt;/li&gt;
&lt;li&gt;As if that weren't enough, the grammar2spec stylesheet has logic that looks for additional attributes (an example is &lt;code&gt;@alias-for&lt;/code&gt;) which are not even allowed by the DTD let alone being in active use.&lt;/li&gt;
&lt;li&gt;The "if" logic to assign productions to different languages (xpath, xquery, XSLT patterns) is hard to maintain and could be automated: just search for productions that are reachable from the top-level production for each language. This could be done by a preprocessing stylesheet that generates a grammar file for each language.&lt;/li&gt;
&lt;li&gt;The switch into a precedence-based grammar for binary operators (g:exprProduction name="OperatorExpr") doesn't really help anyone. For generating production rules in the spec, it just complicates the generation logic. The same is true for anyone else writing applications that use the grammar as input. It doesn't really make life easier for maintainers of the grammar, because it means there is more to learn.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;All the JavaCC machinery is still in the repo and I think it could probably go. Leaving stuff like that lying around makes things more difficult when you need to search filestore for references to things.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>
