<item>
   <title>Issue #1706 created</title>
   <pubDate>2025-01-16T21:08:24Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/1706</link>
   <guid>https://qt4cg.org/@qt4cg/2025/#created-1706</guid>
   <description>&lt;div&gt;&lt;p&gt;Ambiguous `if` syntax&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;The optional &lt;code&gt;else&lt;/code&gt; in a braced &lt;code&gt;if&lt;/code&gt; expression introduces an ambiguity in the XQuery 4.0 grammar.&lt;/p&gt;
&lt;p&gt;Here is an example of an ambiguous expression:&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-xquery"&gt;if (A) then if (B) {C} else if (D) {E} else if (F) {G} else {H}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It can be parsed like this&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-xquery"&gt;if (A) then if (B) {C}                               else {}
       else if (D) {E} else if (F) {G} else {H}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;but also like the following&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-xquery"&gt;if (A) then if (B) {C} else if (D) {E}               else {}
       else if (F) {G} else {H}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The corresponding part of the grammar is&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;IfExpr   ::= 'if' '(' Expr ')' ( UnbracedActions | BracedActions )
UnbracedActions
         ::= 'then' ExprSingle 'else' ExprSingle
BracedActions
         ::= ThenAction ElseIfAction* ElseAction?
ThenAction
         ::= EnclosedExpr
ElseIfAction
         ::= 'else' 'if' '(' Expr ')' EnclosedExpr
ElseAction
         ::= 'else' EnclosedExpr
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The ambiguity could be resolved by making the &lt;code&gt;ElseAction&lt;/code&gt; in &lt;code&gt;BracedActions&lt;/code&gt; mandatory, i.e.:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;BracedActions
         ::= ThenAction ElseIfAction* ElseAction
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>
