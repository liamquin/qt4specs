<!DOCTYPE HTML><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"><link rel="stylesheet" href="/css/status.css"><title>@qt4cg statuses</title></head><body><main><article><h1>@qt4cg statuses</h1><p>This page displays recent status
            updates
            about the QT4CG project.</p><p>The are also captured in <a href="status.rss">an RSS feed</a>.</p><p>By year: <a href="2024/">2024</a>, <a href="2023/">2023</a>, <a href="2022/">2022</a>, <a href="2021/">2021</a>, <a href="2020/">2020</a></p><div class="toots">
<div class="toot" id="minutes-12-10"><h2>QT4 CG meeting 102 draft minutes<span class="toot-id"> #minutes-12-10</span></h2><div class="pubdate">10 Dec at 17:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2024/12-10">https://qt4cg.org/meeting/minutes/2024/12-10</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1616"><h2>Issue #1616 closed<span class="toot-id"> #closed-1616</span></h2><div class="pubdate">10 Dec at 17:21:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1616">https://github.com/qt4cg/qtspecs/pull/1616</a></div><p>A little cleanup; support function/xfunction globally</p></div>
<div class="toot" id="closed-1636"><h2>Issue #1636 closed<span class="toot-id"> #closed-1636</span></h2><div class="pubdate">10 Dec at 17:18:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1636">https://github.com/qt4cg/qtspecs/pull/1636</a></div><p>Initial conversion of EXPath Binary/File</p></div>
<div class="toot" id="closed-1103"><h2>Issue #1103 closed<span class="toot-id"> #closed-1103</span></h2><div class="pubdate">10 Dec at 17:15:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1103">https://github.com/qt4cg/qtspecs/issues/1103</a></div><p>CSV Parsing - handling line ending normalization</p></div>
<div class="toot" id="closed-1643"><h2>Issue #1643 closed<span class="toot-id"> #closed-1643</span></h2><div class="pubdate">10 Dec at 17:15:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1643">https://github.com/qt4cg/qtspecs/pull/1643</a></div><p>1103 Normalize line endings in CSV prior to parsing</p></div>
<div class="toot" id="closed-1637"><h2>Issue #1637 closed<span class="toot-id"> #closed-1637</span></h2><div class="pubdate">10 Dec at 17:12:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1637">https://github.com/qt4cg/qtspecs/issues/1637</a></div><p>Obsolete note in fn:function-lookup</p></div>
<div class="toot" id="closed-1642"><h2>Issue #1642 closed<span class="toot-id"> #closed-1642</span></h2><div class="pubdate">10 Dec at 17:12:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1642">https://github.com/qt4cg/qtspecs/pull/1642</a></div><p>1637 Add/Amend notes to fn:function-lookup</p></div>
<div class="toot" id="closed-1554"><h2>Issue #1554 closed<span class="toot-id"> #closed-1554</span></h2><div class="pubdate">10 Dec at 17:10:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1554">https://github.com/qt4cg/qtspecs/issues/1554</a></div><p>XQFO: Formal Specification</p></div>
<div class="toot" id="closed-1641"><h2>Issue #1641 closed<span class="toot-id"> #closed-1641</span></h2><div class="pubdate">10 Dec at 17:10:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1641">https://github.com/qt4cg/qtspecs/pull/1641</a></div><p>1554-change-formal-specification-heading</p></div>
<div class="toot" id="closed-1639"><h2>Issue #1639 closed<span class="toot-id"> #closed-1639</span></h2><div class="pubdate">10 Dec at 17:01:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1639">https://github.com/qt4cg/qtspecs/issues/1639</a></div><p>Rules for schema-aware elements-to-maps are incomplete</p></div>
<div class="toot" id="closed-1640"><h2>Issue #1640 closed<span class="toot-id"> #closed-1640</span></h2><div class="pubdate">10 Dec at 17:01:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1640">https://github.com/qt4cg/qtspecs/pull/1640</a></div><p>1639 Add missing rule for elements-to-maps</p></div>
<div class="toot" id="closed-1628"><h2>Issue #1628 closed<span class="toot-id"> #closed-1628</span></h2><div class="pubdate">10 Dec at 16:58:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1628">https://github.com/qt4cg/qtspecs/issues/1628</a></div><p>XQuery version number</p></div>
<div class="toot" id="closed-1629"><h2>Issue #1629 closed<span class="toot-id"> #closed-1629</span></h2><div class="pubdate">10 Dec at 16:58:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1629">https://github.com/qt4cg/qtspecs/pull/1629</a></div><p>1628 Clarify rules for XQuery version declaration</p></div>
<div class="toot" id="created-1651"><h2>Issue #1651 created<span class="toot-id"> #created-1651</span></h2><div class="pubdate">10 Dec at 15:10:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1651">https://github.com/qt4cg/qtspecs/issues/1651</a></div><details><summary>Ordered Maps: maps that retain insertion order</summary><div class="markup"><p>Currently, XDM maps are “unordered”: An implementation is allowed to organize entries in a way that optimizes lookup, not order. The entries do not have a predictable order unless they are explicitly sorted.</p>
<p>There are cases in which it is helpful if the “insertion order” is preserved – i.e., the order in which new map entries are added to a map. While the insertion order is not relevant if a map is exclusively used for lookups, it may be beneficial if the input includes deliberately sorted key/value pairs, such as (often) in JSON data, configurations or key/value sequences.</p>
<p>I created this issue because there was some confusion in #564, and on Slack, about this map flavor and “sorted maps”, which are discussed in issue #564: Sorted maps hold all map entries sorted by the key, using a comparator or (in its basic variant) <code>fn:data#1</code>.</p>
<p>PR #1609 attempts to solve both requirements at once.</p>
</div></details></div>
<div class="toot" id="created-1650"><h2>Issue #1650 created<span class="toot-id"> #created-1650</span></h2><div class="pubdate">10 Dec at 09:52:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1650">https://github.com/qt4cg/qtspecs/issues/1650</a></div><details><summary>fn:node-kind, fn:type-of: Editorial</summary><div class="markup"><ul>
<li><code>fn:node-kind</code> is still listed in the function index</li>
<li><code>fn:type-of</code>: <code>type-of($e//doc/child::node())</code> → <code>type-of($e/child::node())</code></li>
</ul>
</div></details></div>
<div class="toot" id="agenda-12-10"><h2>QT4 CG meeting 102 draft agenda<span class="toot-id"> #agenda-12-10</span></h2><div class="pubdate">09 Dec at 11:10:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2024/12-10">https://qt4cg.org/meeting/agenda/2024/12-10</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="closed-1635"><h2>Issue #1635 closed<span class="toot-id"> #closed-1635</span></h2><div class="pubdate">09 Dec at 10:33:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1635">https://github.com/qt4cg/qtspecs/pull/1635</a></div><p>Abbreviate suffixes on cross-spec links</p></div>
<div class="toot" id="created-1649"><h2>Issue #1649 created<span class="toot-id"> #created-1649</span></h2><div class="pubdate">06 Dec at 23:18:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1649">https://github.com/qt4cg/qtspecs/issues/1649</a></div><details><summary>Result type of fn:function-annotations()</summary><div class="markup"><p>The function signature and the prose rules say</p>
<p>The result is a sequence of maps, each being an instance of <code>record(key as xs:QName, value as xs:anyAtomicType*)</code></p>
<p>But one of the examples returns a singleton map in which the QName is the key and the value is the associated value. The test cases also follow that pattern.</p>
</div></details></div>
<div class="toot" id="created-1648"><h2>Issue #1648 created<span class="toot-id"> #created-1648</span></h2><div class="pubdate">06 Dec at 23:00:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1648">https://github.com/qt4cg/qtspecs/issues/1648</a></div><details><summary>fn:elements-to-maps: Types</summary><div class="markup"><p>Copied from https://github.com/qt4cg/qtspecs/issues/1592#issuecomment-2493270899:</p>
<p>With regard to types, I would propose to introduce a separate option:</p>
<pre><code class="language-xquery">elements-to-maps(
  &lt;value&gt;42&lt;/value&gt;,
  { 'types': { 'value': 'number' } }
)

→ { "value": 42 }
</code></pre>
<p>I have a preference for strings, as we can prefix them with <code>@</code>. Next, the representation could be identical to the result, which I believe is more intuitive:</p>
<pre><code class="language-xquery">elements-to-maps(
  &lt;value count='3'/&gt;
  { 'types': { '@count': 'number' } }
)

→ { "value": { "@count": 3 } }
</code></pre>
<p>Of course, we could also have two options (<code>element-types</code>, <code>attribute-types</code>).</p>
</div></details></div>
<div class="toot" id="created-1647"><h2>Issue #1647 created<span class="toot-id"> #created-1647</span></h2><div class="pubdate">06 Dec at 22:56:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1647">https://github.com/qt4cg/qtspecs/issues/1647</a></div><details><summary>fn:elements-to-maps: Explicit Layouts</summary><div class="markup"><p>If a user chooses a custom layout, it should always be applied, or (if inappropriate, by all means) an error message should be raised.</p>
<p>The rationale: I think that the current fallback behavior is flawed. Explicit settings should never be overridden by implicit choices.</p>
</div></details></div>
<div class="toot" id="created-1646"><h2>Issue #1646 created<span class="toot-id"> #created-1646</span></h2><div class="pubdate">06 Dec at 22:49:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1646">https://github.com/qt4cg/qtspecs/issues/1646</a></div><details><summary>fn:elements-to-maps: Robustness</summary><div class="markup"><p>Copied from https://github.com/qt4cg/qtspecs/issues/1592#issuecomment-2493187896 and https://github.com/qt4cg/qtspecs/issues/1592#issuecomment-2495502890:</p>
<p>[USER2] More user feeback:</p>
<blockquote>
<p>It’s confusing that the following function calls lead to completely different outputs:</p>
</blockquote>
<pre><code class="language-xquery">elements-to-maps(
  &lt;person&gt;
    &lt;name&gt;Akila&lt;/name&gt;
    &lt;age&gt;34&lt;/age&gt;
  &lt;/person&gt;
)

{"person":{"name":"Akila","age":"34"}}

elements-to-maps(
  &lt;person&gt;
    &lt;name&gt;Akila&lt;/name&gt;
    &lt;name&gt;Jaha&lt;/name&gt;
    &lt;age&gt;34&lt;/age&gt;
  &lt;/person&gt;
)

{"person":[{"name":"Akila"},{"name":"Jaha"},{"age":"34"}]}
</code></pre>
<hr>
<p>The initial feedback I gathered so far is that the function works fine if the input is regular and uniform, but as soon as there are slight deviations, it can get wild. Here are some plain examples how a small change to the input results in fairly different output:</p>
<pre><code class="language-xquery">&lt;xml&gt;
  &lt;info&gt;X&lt;/info&gt;
  &lt;address&gt;A&lt;/address&gt;&lt;address&gt;B&lt;/address&gt;
&lt;/xml&gt;
→ { "xml": ["A", "B"] }

&lt;xml&gt;
  &lt;info&gt;X&lt;/info&gt;
  &lt;address&gt;A&lt;/address&gt;
  &lt;address&gt;B&lt;/address&gt;
&lt;/xml&gt;
→ { "xml": [{ "info": "X" }, { "address": "A" }, { "address": "B" }] }

&lt;xml id='id0'&gt;
  &lt;address&gt;A&lt;/address&gt;
  &lt;address&gt;B&lt;/address&gt;
&lt;/xml&gt;
→ { "xml": { "@id": "id0", "address": ["A", "B"] } }
</code></pre>
<hr>
<p>Possible solutions:</p>
<ul>
<li>Enable <code>uniform</code> by default (performance considerations should not outweigh usability concerns)</li>
<li>Change the rules for <code>record</code> from <code>all-different(*!node-name())</code> to <code>not(all-equal(*!node-name()))</code></li>
<li>Editorial changes: Stress in the introduction that robustness is a secondary requirement.</li>
</ul>
</div></details></div>
<div class="toot" id="created-1645"><h2>Issue #1645 created<span class="toot-id"> #created-1645</span></h2><div class="pubdate">06 Dec at 22:38:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1645">https://github.com/qt4cg/qtspecs/issues/1645</a></div><details><summary>fn:elements-to-maps: Debugging</summary><div class="markup"><p>Copied from https://github.com/qt4cg/qtspecs/issues/1592#issuecomment-2493180757, slightly revised:</p>
<p>For regular data, it is convenient to have heuristics that choose layouts automatically. For slightly irregular data that needs manual revisions, it can get messy:</p>
<p>[USER1] User feedback:</p>
<blockquote>
<p>I have no idea which layout is used for my XML data. A function would be helpful that does not return the transformed data, but the layouts used for the transformation.</p>
</blockquote>
<p>We could…</p>
<ul>
<li>offer an extra function,</li>
<li>add a <code>debug</code> option to trace layout information, or</li>
<li>add an option to include layouts in the output:</li>
</ul>
<pre><code class="language-xquery">&lt;p&gt;&lt;a&gt;A&lt;/a&gt;&lt;b&gt;B&lt;/b&gt;&lt;c/&gt;&lt;/p&gt; =&gt; elements-to-maps({ 'debug': true() })

{
  "p(record)": {
    "a(simple)": "A",
    "b(simple)": "B",
    "c(empty)": ""
  }
}
</code></pre>
</div></details></div>
<div class="toot" id="created-1644"><h2>Issue #1644 created<span class="toot-id"> #created-1644</span></h2><div class="pubdate">06 Dec at 22:33:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1644">https://github.com/qt4cg/qtspecs/issues/1644</a></div><details><summary>fn:elements-to-maps: Mixed Content</summary><div class="markup"><p>Even though the function may not be used primarily for mixed content, we should make it easier to convert such XML input to maps/JSON.</p>
<p>If I understand correctly, the safest solution to retrieve a consistent result currently is:</p>
<pre><code class="language-xquery">fn:elements-to-maps(
  $mixed-content,
  { "disable-layouts": ("empty", "empty-plus",
      "simple", "simple-plus", "list",
      "list-plus", "record", "sequence")
  }
)
</code></pre>
<p>Maybe we can simplify this? If we had an inclusive option, it could possibly be:</p>
<pre><code class="language-xquery">fn:elements-to-maps(
  $mixed-content,
  { "enable-layouts": "mixed" }
)
</code></pre>
<p>We could also consider <code>xml:space=''preserve</code> attributes and apply <code>mixed</code> to all descendant nodes (but it shouldn't be the only solution).</p>
<p>Related: #1592</p>
</div></details></div>
<div class="toot" id="created-1643"><h2>Pull request #1643 created<span class="toot-id"> #created-1643</span></h2><div class="pubdate">06 Dec at 21:49:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1643">https://github.com/qt4cg/qtspecs/pull/1643</a></div><details><summary>1103 Normalize line endings in CSV prior to parsing</summary><div class="markup"><p>Fix #1103</p>
<p>Simplifies the spec by doing line-ending normalization unconditionally prior to CSV parsing. CRLF sequences are no longer retained within quoted fields.</p>
</div></details></div>
<div class="toot" id="created-1642"><h2>Pull request #1642 created<span class="toot-id"> #created-1642</span></h2><div class="pubdate">06 Dec at 17:13:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1642">https://github.com/qt4cg/qtspecs/pull/1642</a></div><details><summary>1637 Add/Amend notes to fn:function-lookup</summary><div class="markup"><p>Fix #1637</p>
</div></details></div>
<div class="toot" id="created-1641"><h2>Pull request #1641 created<span class="toot-id"> #created-1641</span></h2><div class="pubdate">06 Dec at 16:58:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1641">https://github.com/qt4cg/qtspecs/pull/1641</a></div><details><summary>1554-change-formal-specification-heading</summary><div class="markup"><p>Fix #1554</p>
<p>Changes the heading "formal specification" to "formal equivalent", and expands on the explanatory text.</p>
</div></details></div>
<div class="toot" id="created-1640"><h2>Pull request #1640 created<span class="toot-id"> #created-1640</span></h2><div class="pubdate">06 Dec at 15:14:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1640">https://github.com/qt4cg/qtspecs/pull/1640</a></div><details><summary>1639 Add missing rule for elements-to-maps</summary><div class="markup"><p>Fix #1639</p>
</div></details></div>
<div class="toot" id="created-1639"><h2>Issue #1639 created<span class="toot-id"> #created-1639</span></h2><div class="pubdate">06 Dec at 12:30:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1639">https://github.com/qt4cg/qtspecs/issues/1639</a></div><details><summary>Rules for schema-aware elements-to-maps are incomplete</summary><div class="markup"><p>The rules for schema-aware layout selection produce no answer in the case where the element has a simple type but empty layout and simple layout are both disabled.</p>
<p>I propose to fall back to "mixed" layout in this case.</p>
</div></details></div>
<div class="toot" id="closed-1630"><h2>Issue #1630 closed<span class="toot-id"> #closed-1630</span></h2><div class="pubdate">05 Dec at 15:43:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1630">https://github.com/qt4cg/qtspecs/pull/1630</a></div><p>Two minor corrections of `minus-sign` spec</p></div>
<div class="toot" id="created-1638"><h2>Pull request #1638 created<span class="toot-id"> #created-1638</span></h2><div class="pubdate">05 Dec at 15:42:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1638">https://github.com/qt4cg/qtspecs/pull/1638</a></div><details><summary>1634 Update description of decimal properties in the static context</summary><div class="markup"><p>Fix #1634</p>
<p>Supersedes #1630</p>
</div></details></div></div><p>See 3306
            more statuses in yearly archives.</p></article></main></body></html>